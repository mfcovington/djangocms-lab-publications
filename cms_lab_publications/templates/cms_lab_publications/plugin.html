{% load cms_tags sekizai_tags staticfiles %}


{% block content %}

  {% addtoblock "css" %}
    <link href="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{% static 'cms_lab_publications/app.css' %}">
  {% endaddtoblock %}

  <div id="publication-list">
    <form style="display:inline;">

      {% include "cms_lab_publications/_header-with-search-filter.html" with publication_set=instance.publication_set %}

      <ul class="list" style="list-style: none; padding-left: 0;">
        {% for publication in instance.publication_set.publications.all %}
          <li>
            <p class="citation">
              {{ publication.citation }}
              <span class="btn-group btn-group-xs" role="group" aria-label="publication-buttons">
                {% include "cms_lab_publications/_buttons.html" %}
              </span>
            </p>

            <!-- Hidden search/filter fields -->
            <p class="abstract" style="display: none;">{{ publication.abstract }}</p>
            <p class="authors" style="display: none;">{{ publication.authors }}</p>
            <p class="tags" style="display: none;">{% for tag in publication.tags.values %}{{ tag.id }} {% endfor %}</p>
          </li>
        {% endfor %}
      </ul>

      {% if instance.publication_set.pagination %}
        <div class="text-center">
          <ul class="pagination"></ul>
        </div>
      {% endif %}
    </form>
  </div>

  {% for publication in instance.publication_set.publications.all %}
    {% include "cms_lab_publications/_modal.html" %}
  {% endfor %}

  {% addtoblock "js" %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/select2/4.0.0/js/select2.min.js"></script>

    <script src="{% static 'cms_lab_publications/js/search-filter-pubs.js' %}"></script>

    <script src="{% static 'cms_lab_publications/js/list.min.js' %}"></script>

    {% if instance.publication_set.pagination %}
      <script src="{% static 'cms_lab_publications/js/list.pagination.min.js' %}"></script>
    {% endif %}

    <script>
      var options = {
        valueNames: [ 'abstract', 'authors', 'citation', 'tags' ],

        {% if instance.publication_set.pagination %}
          page: {{ instance.publication_set.pagination }},
          plugins: [
            ListPagination({})
          ],
        {% endif %}

      };
      var pubList = new List('publication-list', options);
    </script>
  {% endaddtoblock %}

{% endblock content %}
